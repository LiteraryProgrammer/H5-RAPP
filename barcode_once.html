<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<script type="text/javascript" src="js/conf.js">
			
		</script>
		<script type="text/javascript">
			conf.include_CSS(conf.Cmui);
		</script>
		<style type="text/css">
			html,body{
				
				height: 100%;
				
			}
			#bcid
{

background: black;
width: 100%;
height:100%;

}
		</style>
	</head>

	<body>
		<div id="bcid">
			
		</div>
		<!--
		<script type="text/javascript" src="js/jquery-3.1.1.min.js">
			
		</script>
		<script src="js/mui.min.js"></script>
		<script type="text/javascript" src="js/plus_extends.js">
			
		</script>-->
		<script type="text/javascript">
			conf.include_JS(conf.Jquery);
			conf.include_JS(conf.Jmui);
			conf.include_JS(conf.Jplus_extends);
		</script>
		
		<script type="text/javascript">
		

	var ws_id,ws_from,input_id;//源窗口的ID，源窗口对象，以及需要获取返回数据的INPUT控件ID
			
				

		document.addEventListener('get_ws',function(event){
					
					ws_id=event.detail.wsID;//获取事件源的窗口ID
					input_id=event.detail.inputID;//获取事件源的控件ID
					
					ws_from=plus.webview.getWebviewById(ws_id);
					console.log(ws_id+'/'+input_id);
				})
			
			mui.plusReady(function(){
			ks.init();
				//监听是从哪个窗口调用了扫描
				mui.back=function(){
					
					//console.log('关闭');
					var curws=	plus.webview.getWebviewById('barcode_once.html');
				
					curws.close();
					
				}
				//console.log(ks.a);
			ks.plus_barcode_once(function(res){
					
					//将结果传回源窗口,并关闭当前窗口
					//console.log('准备发送数据回去'+ws_from);
					mui.fire(ws_from,input_id,{
						
						result:res,
						input_id:input_id
						
					});
					
				var curws=	plus.webview.getWebviewById('barcode_once.html');
				
					curws.close();
					
					
				});
				
				
				
				
				
			})
			
			
		</script>
	</body>

</html>